---
import CallToAction from "./ui/CallToAction.astro";
---

<section id="methodology" class="bg-[#F6F6F6] py-20">
  <div class="max-w-7xl mx-auto px-6 lg:px-8">

    <!-- Encabezado -->
    <div class="text-center mb-16">
      <h2 class="text-4xl md:text-5xl font-bold text-[#0a2540]">
        Así Garantizamos su <span class="text-[#f95738]">Avance Rápido</span>
      </h2>
      <p class="mt-4 text-gray-600 max-w-2xl mx-auto">
        No perdemos tiempo. Nuestro modelo está diseñado para pasar de la idea al lanzamiento 
        en el menor tiempo posible, garantizando que el <strong>ascenso de su marca</strong> sea firme y sostenido.
      </p>
    </div>

    <!-- Fases -->
    <div class="grid lg:grid-cols-3 md:grid-cols-2 gap-8 methodology-grid">

      <!-- FASE I -->
      <article id="fase1" class="card-modal">
        <div class="card-summary">
          <div class="text-sm font-bold text-[#f95738] tracking-wider mb-2">
            FASE I: CIMA RÁPIDA
          </div>
          <h3 class="text-2xl font-semibold text-[#0a2540] mb-4">
            El Blueprint de Ataque <span class="text-gray-500 text-sm">(Estrategia)</span>
          </h3>
          <p class="text-gray-600 leading-relaxed mb-6">
            Definimos su posición, mensaje clave y los 3 primeros <em>shots</em> de marketing 
            con el mayor potencial de retorno. <strong>Menos papel, más acción.</strong>
          </p>
          <br>
          <!-- Botón para abrir modal -->
          <a href="#fase1" class="btn-info" role="button" aria-label="Abrir más información de Fase I">Más info</a>
        </div>

        <!-- Contenido del modal -->
        <div class="card-details">
          <a href="#methodology" class="close-btn" aria-label="Cerrar">✕</a>

          <div class="text-sm font-bold text-[#f95738] tracking-wider mb-2">
            FASE I: CIMA RÁPIDA
          </div>
          <h3 class="text-2xl font-semibold text-[#0a2540] mb-3">
            El Blueprint de Ataque — Detalle
          </h3>

          <p class="text-gray-700 leading-relaxed mb-3">
            <strong>Análisis profundo de su marca y competencia.</strong><br />
            Revisamos cómo se comunica su negocio en redes, qué hacen sus competidores y quién es su público ideal. 
            Con esa base, definimos objetivos claros para la campaña (más clics, nuevos contactos y ventas medibles).
          </p>

          <p class="text-gray-700 leading-relaxed mb-3">
            <strong>Diseño del recorrido de conversión.</strong><br />
            Trazamos un plan que guía a su audiencia paso a paso: primero los atraemos, luego generamos interés
            y finalmente los convertimos en clientes.
          </p>

          <p class="text-gray-700 leading-relaxed mb-3">
            <strong>Plan de anuncios inteligente.</strong><br />
            Elegimos formatos y mensajes para cada etapa y definimos a qué públicos dirigirnos para obtener resultados.
          </p>

          <p class="text-gray-700 leading-relaxed">
            <strong>Configuración técnica lista para medir.</strong><br />
            Dejamos su cuenta de Meta Business Suite bien conectada (píxel, eventos y audiencias) para medir qué funciona
            y escalar con seguridad.
          </p>
        </div>
      </article>

      <!-- FASE II -->
      <article id="fase2" class="card-modal">
        <div class="card-summary">
          <div class="text-sm font-bold text-[#f95738] tracking-wider mb-2">
            FASE II: LOMADA EN MOVIMIENTO
          </div>
          <h3 class="text-2xl font-semibold text-[#0a2540] mb-4">
            Activación y Construcción de Plataformas
          </h3>
          <p class="text-gray-600 leading-relaxed mb-6">
            Construimos o ajustamos su web. Lanzamos su nueva identidad y creamos los activos 
            de alto impacto para sus redes sociales. Todo con mentalidad de <strong>testeo continuo</strong>.
          </p>

          <!-- Botón para abrir modal -->
          <a href="#fase2" class="btn-info" role="button" aria-label="Abrir más información de Fase II">Más info</a>
        </div>

        <div class="card-details">
          <a href="#methodology" class="close-btn" aria-label="Cerrar">✕</a>

          <div class="text-sm font-bold text-[#f95738] tracking-wider mb-2">
            FASE II: LOMADA EN MOVIMIENTO
          </div>
          <h3 class="text-2xl font-semibold text-[#0a2540] mb-3">
            Activación y Construcción — Detalle
          </h3>

          <p class="text-gray-700 leading-relaxed mb-3">
            <strong>Web lista para convertir.</strong><br />
            Optimizamos la estructura, velocidad y mensajes clave para que su sitio convierta visitas en oportunidades reales.
          </p>
          <p class="text-gray-700 leading-relaxed mb-3">
            <strong>Identidad y activos con impacto.</strong><br />
            Ajustamos identidad visual y creamos piezas para redes (imágenes y videos) enfocadas en atención y respuesta.
          </p>
          <p class="text-gray-700 leading-relaxed">
            <strong>Prueba y mejora continua.</strong><br />
            Publicamos, medimos y ajustamos rápidamente para quedarnos con lo que mejor rinde.
          </p>
        </div>
      </article>

      <!-- FASE III -->
      <article id="fase3" class="card-modal">
        <div class="card-summary">
          <div class="text-sm font-bold text-[#f95738] tracking-wider mb-2">
            FASE III: ASCENSO ACELERADO
          </div>
          <h3 class="text-2xl font-semibold text-[#0a2540] mb-4">
            Gestión Multicanal y Escalada
          </h3>
          <p class="text-gray-600 leading-relaxed mb-6">
            Es la fase de crecimiento. Activamos la estrategia multicanal 
            (<strong>Ads + Redes + Email</strong>) y optimizamos los presupuestos a diario. 
            Solo invertimos en lo que <strong>sabemos que funciona</strong>.
          </p>

          <!-- Botón para abrir modal -->
          <a href="#fase3" class="btn-info" role="button" aria-label="Abrir más información de Fase III">Más info</a>
        </div>

        <div class="card-details">
          <a href="#methodology" class="close-btn" aria-label="Cerrar">✕</a>

          <div class="text-sm font-bold text-[#f95738] tracking-wider mb-2">
            FASE III: ASCENSO ACELERADO
          </div>
          <h3 class="text-2xl font-semibold text-[#0a2540] mb-3">
            Gestión y Escalada — Detalle
          </h3>

          <p class="text-gray-700 leading-relaxed mb-3">
            <strong>Multicanal coordinado.</strong><br />
            Unimos anuncios, contenidos orgánicos y email marketing para mantener el flujo de clientes potenciales.
          </p>
          <p class="text-gray-700 leading-relaxed mb-3">
            <strong>Optimización diaria.</strong><br />
            Ajustamos audiencias, creatividades y presupuestos según resultados para maximizar el retorno.
          </p>
          <p class="text-gray-700 leading-relaxed">
            <strong>Escalado con control.</strong><br />
            Invertimos más en lo que prueba resultados, y pausamos lo que no rinde — sin despilfarrar presupuesto.
          </p>
        </div>
      </article>

      <!-- OVERLAY (cierra al hacer clic afuera) -->
      <a href="#methodology" class="overlay" aria-hidden="true"></a>
    </div>

    <CallToAction />
  </div>
</section>

<style>
  /* Bloqueo del scroll del documento (CSS puro) */
  html:has(.card-modal:target),
  body:has(.card-modal:target) {
    overflow: hidden;
    overscroll-behavior: contain;
    touch-action: none;
  }

  /* Base card */
  .card-modal {
    position: relative;
    background: #fff;
    border: 1px solid #e5e7eb;
    border-radius: 1rem;
    padding: 2rem;
    box-shadow: 0 4px 12px rgba(0,0,0,.05);
    transition: box-shadow .2s ease, transform .2s ease;
  }
  .card-modal:hover { box-shadow: 0 8px 24px rgba(0,0,0,.08); }

  /* Botón “Más info” */
  .btn-info {
    display: inline-block;
    padding: .55rem .9rem;
    border-radius: .75rem;
    border: 1px solid #f95738;
    text-decoration: none;
    font-weight: 600;
    color: #fff;
    background: #f95738;
    box-shadow: 0 1px 2px rgba(0,0,0,.04);
  }
  .btn-info:hover { filter: brightness(.98); }
  .btn-info:focus { outline: 2px solid #0a2540; outline-offset: 2px; }

  /* Mostrar/ocultar contenido según estado */
  .card-summary { display: block; }
  .card-details { display: none; }

  .card-modal:target .card-summary { display: none; }
  .card-modal:target .card-details { display: block; }

  /* Estado expandido (modal) */
  .card-modal:target .card-details {
    position: fixed;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    z-index: 50;
    width: min(92vw, 920px);
    max-height: 85vh;
    overflow: auto;
    padding: 2.5rem;
    box-shadow: 0 24px 80px rgba(0,0,0,.22);
    border-radius: 1rem;
    background: #fff;
    animation: pop .18s ease-out;
  }

  @keyframes pop {
    from { transform: translate(-50%, -50%) scale(1.02); opacity: .95; }
    to   { transform: translate(-50%, -50%) scale(1); opacity: 1; }
  }

  /* Botón cerrar en el modal */
  .close-btn {
    position: absolute;
    top: .75rem;
    right: .75rem;
    padding: .4rem .6rem;
    border-radius: 999px;
    border: 1px solid #e5e7eb;
    background: rgba(255,255,255,.96);
    box-shadow: 0 2px 6px rgba(0,0,0,.08);
    font-size: 1rem;
    line-height: 1;
    color: #0a2540;
    z-index: 60;
    cursor: pointer;
    text-decoration: none;
  }
  .close-btn:hover { filter: brightness(.98); }

  /* Overlay */
  .overlay { display: none; }
  .card-modal:target ~ .overlay {
    display: block;
    position: fixed;
    inset: 0;
    z-index: 40;
    background: rgba(0,0,0,.22);
    backdrop-filter: blur(6px);
  }

  /* Evitar subrayados globales en la card */
  .card-modal, .card-modal * { text-decoration: none; }
</style>
